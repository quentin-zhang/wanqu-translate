Twelve-Factor应用方法是十二的最佳实践构建现代,原生云应用程序。指导诸如配置、部署、运行时,和多个服务通信、Twelve-Factor模型规定了最佳实践,适用于不同的用例,从数据处理应用程序的web应用程序和api。尽管serverless计算和AWSλ已经改变了应用程序开发完成,Twelve-Factor最佳实践保持相关和适用于serverless世界。 
 在这篇文章中,我直接应用和比较Twelve-Factor方法与λserverless应用程序开发和Amazon API网关。 
 如您所见,许多这些因素不仅是直接适用于serverless应用程序,但实际上一个默认机制或AWS serverless平台的能力。其他因素不适合,我讨论这些因素如何在serverless方法可能不适用。 
 一个代码库跟踪版本控制,许多部署 
 一个通用的软件开发最佳实践是在版本控制你所有的代码。这是与serverless应用程序没有什么不同。 
 对于一个serverless应用程序,您的代码应该存储在一个存储库中,一个单一的可部署的工件生成和部署。这个单一代码库也应该代表你所有的应用程序环境中使用的代码(开发、分期、生产,等等)。serverless可能不同应用程序的界限是什么是“单一应用程序。” 
 这里有两个指南帮助您理解应用程序的范围: 
 以下两个指南可以帮助你保持你的serverless应用程序作用域的一个目的,帮助防止代码库的复杂性。 
 显式地声明和隔离依赖性 
 代码需要使用多个函数应该打包成自己的图书馆,包括在您的部署包。回到前一个因素的代码库,如果你发现你需要经常包括特殊处理或业务逻辑,最好的解决方法可能是自己试图创建一个有目的的库。λ支持的每种语言有依赖关系的模型/库,您可以使用: 
 你会想和CI / CD自动化这个过程,我讲到这篇文章。 
 存储配置环境中 
 λ和API网关允许您设置配置信息,使用每个服务运行的环境。 
 在λ,这些被称为环境变量和键值时,可以设置在部署或更新功能配置。λ然后让这些键值对Lambda函数代码使用标准api支持的语言,这样的过程。env节点。js函数。有关更多信息,请参见编程模型,其中包含为每个受支持的语言的例子。 
 λ还允许您使用的加密这些键值对公里,这样它们可以用于存储秘密如API密钥或密码数据库。您也可以使用它们来帮助定义应用程序环境的细节,如差异测试或生产环境中,您可能具有独特的数据库或Lambda函数需要界面的端点。你也可以使用这些设置A / B测试旗帜或启用或禁用某些功能逻辑。 
 API网关,这些配置变量称为阶段变量。像环境变量在λ,这些键值可用于API网关消费或传递给API的后端服务。发送请求阶段变量可以有用不同的后端环境中基于API访问的URL。例如,一个配置可以同时支持beta.yourapi.com和prod.yourapi.com。您还可以使用阶段变量 
 将信息传递给Lambda函数,使其执行不同的逻辑。 
 治疗支持服务作为附加资源 
 因为λ不允许你运行另一个服务作为您的函数执行的一部分,这个因素基本上是λ的默认模式。通常,您参考任何数据库或数据存储作为外部资源通过HTTP端点或DNS名称。这些连接字符串是理想情况下通过配置信息传入,正如前面所覆盖。 
 严格区分构建和运行阶段 
 分离构建、发布和运行阶段遵循开发最佳实践的持续集成和交付。AWS建议你有一个CI cd过程无论您正在构建什么类型的应用程序。对于serverless应用程序,这是没有什么不同。有关更多信息,请参见建筑CI / CD Serverless应用程序的管道(SRV302)re:发明2017年会议。 
 一个最小的管道(从上面演示链接) 
 执行应用程序作为一个或多个无状态的过程 
 这是固有的λ是怎样设计的所以没有更多的考虑。Lambda函数应该被视为是无状态的,尽管可能在本地存储一些信息的能力执行环境之间重用。这是因为没有保证关联任何执行环境,以及潜在的调用之间的执行环境消失的存在。你应该任何状态信息存储在一个数据库,通过支持缓存,或单独的数据存储服务。 
 通过港口出口服务绑定 
 这个因素也不适用于λ,执行环境不暴露任何直接的网络功能。而不是一个港口,Lambda函数通过调用一个或多个触发服务或为λAWS api。目前有三种不同的调用模型: 
 每个人都有独特的特点。有关更多信息,请参见调用Lambda函数。 
 通过流程模型向外扩展 
 λ是建立大规模的并发性和规模。在这个博客上最近的一篇文章,题为《管理AWS Lambda函数并发serverless申请解释说,“规模是并发执行的单位”,这些都是被你的功能。 
 λ自动扩展到满足要求发送的调用你的函数。这与传统的计算模型使用物理主机,虚拟机,或者容器自助的地方。λ,您不需要管理整体能力或应用扩展策略。 
 每个AWS帐户都有一个整体AccountLimit价值,在任何时间点是固定的,但可以很容易地根据需要增加。截至2017年5月,默认的上限是1000个并发执行/ AWS地区。还可以设置和管理保留并发限制,它提供了一种限制并发一个函数可以有多少。它还储备并发能力对于一个给定的函数的总可用一个帐户。 
 最大化的鲁棒性和快速启动和优雅的关闭 
 关闭不适用λλ因为本质上是事件驱动的。直接调用与传入的事件或触发器。 
 然而,在启动时速度很重要。初始函数执行延迟,或所谓的“冷启动”,可以发生在没有一个“温暖”的计算资源可以执行对您的应用程序调用。在AWSλ执行模型的主题,它解释说: 
 “这需要时间来建立一个执行上下文,并做必要的“引导”,增加了一些延迟每次Lambda函数被调用。你通常看到这个延迟首次当Lambda函数调用或者更新后因为AWSλ试图重用Lambda函数的执行上下文的后续调用。” 
 主题的最佳实践介绍了很多问题如何思考ab 
 从你的表现功能。这包括将某种逻辑,如何重用执行环境,以及如何通过配置功能更多的内存你也会成比例的增加CPU用于你的函数。使用AWS x射线,你可以收集一些洞察你的函数在做什么在一个执行,并相应地做出调整。 
 保持发展,过渡和生产尽可能相似 
 持续集成和交付,拥有独立的应用程序环境的实践是一个坚实的最佳实践无论开发方法。在非生产环境中能够安全地测试应用程序是成功发展的关键。产品在AWS Serverless平台不收取空闲时间,大大降低了运行多个环境的成本。您还可以使用AWS Serverless应用程序模型(AWS山姆),管理的配置独立的环境。 
 山姆serverless应用程序允许您模型大大简化AWS CloudFormation语法。山姆,你可以使用CloudFormation等功能作为参数和映射来构建动态模板。随着λ的环境变量和变量API Gateway的阶段,这些模板使您能够从一个模板部署多个环境,如测试、过渡和生产。在非生产环境中使用,你的成本λ和API网关将是零。有关更多信息,请参见AWSλAWS Serverless应用程序与应用程序模型2017 AWS在线科技说话。 
 把日志事件流 
 在典型的non-serverless应用程序环境中,你可能关心的日志文件,日志守护进程和数据的集中代表。值得庆幸的是,这不是一个问题对于serverless应用程序,因为大多数服务平台的为你处理这个问题。 
 λ,你可以输出日志到控制台通过函数的本地语言的能力。更多信息,见日志(去)。类似的文档页面存在其他语言。这些消息输出代码捕获和集中在亚马逊CloudWatch日志。有关更多信息,请参见访问Amazon AWSλCloudWatch日志。 
 API网关提供了两种不同的方法获取日志信息: 
 同时也可用在监测日志。有关更多信息,请参见设置网关API日志API。 
 捕捉日志和能够搜索和查看它们是一回事,但监测日志也给你治疗一个日志消息的能力作为一个事件,并采取行动通过订阅过滤器在服务。通过订阅过滤器,您可以发送日志消息匹配某个模式Lambda函数,并让它在此基础上采取行动。说,例如,你想对某些错误消息或使用模式违反某些规则。你可以对监测日志,订阅过滤器,和λ。CloudWatch日志的另一个重要功能是能够“主”日志信息监测的指标。,你可能需要一个数据点从日志条目,创建一个度量,然后警报指标突破阈值时显示。 
 运行管理/管理任务作为一次性的过程 
 这是另一个因素,并不能直接适用于λ由于其设计。通常,你会你的函数作用域的单一的或有限的用例和单个应用程序的不同组件的功能。即使他们共享一个公共调用资源,如一个API网关端点和阶段,您仍将独立的单个API资源和操作自己的Lambda函数。 
 正如我们所看到的,仍然可以应用于serverless Twelve-Factor应用程序设计应用程序时,考虑到一些微小的差异! 
 下图强调的因素以及如何适用与否他们serverless应用程序: 
 注:一次性的只有一半适用,因为在这篇文章中讨论。 
 如果你已经构建应用程序在云基础设施在过去的几年里,Twelve-Factor方法似乎应该熟悉和简单。然而,如果你是新到这个空间,你应该知道,一般的最佳实践和默认工作模式serverless应用程序与我这里讨论重叠严重。 
 它不需要很多工作要坚持,而紧密Twelve-Factor模型。当你构建serverless应用程序,适用的点列在这里帮助你简化开发和运营工作(尽管已经最小化λ和API等服务网关)。Twelve-Factor方法也不是孤注一掷的。您可以仅适用于实践最适合您和您的应用程序,而且还从中受益。 
 亚马逊网络服务是招聘。 
 亚马逊网络服务(AWS)是一个动态的,不断增长的业务单元在Amazon.com。我们目前正在招聘软件开发工程师、产品经理、账户管理,解决方案架构师,支持工程师、系统工程师、设计师等等。访问我们的职业页面或我们Developer-specific职业页面来了解更多信息。 
   
 亚马逊网络服务是一个机会均等的雇主。 
   
   
  
  
 URL : https://aws.amazon.com/blogs/compute/applying-the-twelve-factor-app-methodology-to-serverless-applications/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website