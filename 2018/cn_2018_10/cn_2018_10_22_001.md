在贝宝,我们最近推出了GraphQL技术栈。 
 如果你还没有听说过GraphQL,REST api是一个广受欢迎的选择,目前以开发世界的风暴! 
 这篇文章需要仔细查看贝宝付款和解释我们的旅程从其他批休息GraphQL和经验教训。 
 贝宝的付款产品遍及许多web和移动应用程序,支持数百万用户在~ 200个国家和数以百计的实验运行在任何时间。这些应用程序利用同一套REST api来获取所需数据构建UI。 
 大约4年前,我们都在休息。我们的api非常干净,小和原子。事情是伟大的开始。其他有严格的设计原则被广泛理解。REST是一个伟大的方式来设计和实现api为您的域。 
 然而,其他的原则不考虑网络和移动应用程序和用户的需求。在一个优化事务尤其如此喜欢结帐。用户希望尽快完成付款。如果你的应用程序是使用原子REST api,你常常使许多往返从客户机到服务器获取数据。结帐,我们发现每一个往返成本至少在网络时间700毫秒(99),不包括在服务器上处理请求的时间。每个往返导致较慢的呈现时间,更多的用户沮丧和较低的检测转换。不用说,往返是邪恶的! 
 当然,你可以建立一个编排API返回所有需要的数据,但这为代价。你叫什么名字吗?GET /着陆页?现在,这似乎是一个JSON API,而不是一个REST API。与编排api,您的客户是耦合到您的服务器。任何时候你添加一个新特性或实验中,你将它添加到您的API。现在你overfetching、性能和用户付出代价。 
 在新的需求出现时,开发人员面临着一个选择:我们应该创建一个新的端点和我们的客户让另一个请求的数据?或者我们应该过载现有端点和更多的数据吗? 
 开发人员常常选择第二个选项,因为它更容易添加另一个字段,防止一个客户机到服务器的往返。随着时间的推移,这将导致您的API变得沉重,简单,和服务超过一个单一的责任。 
 我们开始以极大的意图。我们的API返回的用户信息,送货地址和融资选择。所有你需要建立一个结帐应用。随着时间的推移,用例堆积起来。每个用户支付的成本,这些字段,即使他们不需要他们。 
 编排api看起来很棒,但我们总是后悔以后。 
 其他不为我们工作,所以我们建立了一个批处理REST API来解决其中的一些问题。它是一个动态编排API,允许客户来确定响应的大小和形状。批允许我们结合原子REST请求,减少往返。 
 这是一个批处理请求和响应的一个示例。其他操作的请求包含一幅地图,你指定动词、端点、参数和它们之间的依赖关系。 
 但是,这是很少使用。 
 批,我们喜欢客户控制数据的大小和形状,而不是服务器。释放我们从调整一个编排API每次客户的需求发生了变化。我们没有这样的客户必须密切知道底层的api是如何工作。请求结构足够痛苦为开发者不会使用它。我们也希望能够获得特定字段,而不是大型资源或对象。 
 许多公司(比如Facebook和谷歌),有一批也有同样的问题。作为一个优化,但无证功能,没有一流的方法来获取数据。 
 批休息是一个正确方向的一步,但是不是一个改变游戏规则。 
 去年,我们的经理(Brian Crescimanno)助教 
 编制目录我们两个问题: 
 我们知道,性能是一个问题。我们觉得我们不像我们想要生产。我们知道我们没有花足够的时间构建伟大的UI体验。 
 当我们做了更细致的观察,我们发现UI开发人员花不到1/3的时间实际构建UI。剩下的时间弄清楚在哪里以及如何获取数据,过滤/映射,数据和策划许多API调用。撒上一些构建/部署开销。现在,构建UI的可有可无或马后炮。 
 那时,我们便开始听到关于GraphQL越来越多。我们花了一星期时间,仔细观察GraphQL印象深刻。幸运的是,我们有一个新产品将提供一个移动SDK开发人员想要贝宝付款到他们的应用程序集成。我们有6周船3开发人员构建它。 
 随着团队构建UI,我们建立了并行API。尽管API不准备他们消费,我们还提前功能/代码完成几乎没有贝宝部落的必要知识。开发人员没有发现哪个内部API调用,如何调用它,将这些数据转换成他们可以使用的东西。找出他们检查我们的模式是有可能的,写了GraphQL查询(JSON,没有双引号),他们需要什么,并保持迭代的UI。 
 我们意识到我们在上什么东西似的。我们开发人员的生产力,我们的应用程序是快速和我们的用户高兴。我们在GraphQL都压。 
 性能——你只能得到你要的数据。不能多也不能少。单一的往返。你也可以查询作为变异的一部分! 
 灵活性——客户确定数据的大小和形状,而不是服务器。 
 开发人员的生产力,立即生产,没有部落的知识。你知道,如果你知道JSON GraphQL。令人难以置信的工具! 
 进化——GraphQL,API的开发人员知道他们的客户正在使用和能够做出更好的选择,当不以为然的或进化的API。休息,这是不可能的所以你扩展和永远不会删除。 
 移动SDK仅仅是个开始。我们现在修补我们的贝宝付款旗舰产品GraphQL和反应。如果你在美国的话,很有可能您正在使用我们的新栈。这是快得多。? 
 GraphQL正在贝宝的风暴。一年后,我们有30多个应用程序/团队构建api或使用api。It’s☀️不是所有的阳光和彩虹?.一路上我们犯了一些错误,值得分享。 
 请继续关注更多关于GraphQL的帖子在贝宝!我们将分享我们的想法:模式设计最佳实践、身份验证和授权,插装你GraphQL API,一个生产就绪的检查表,远程模式缝合在实践中,在大型组织和部署GraphQL。 
 我们招聘!?如果你愿意来工作在前端infrastructure,GraphQL或反应PayPal,DM我在@mark_stuart!在Twitter上 
 首席工程师/建筑师。@贝宝主要前端基础设施。精英语言h4x0r。 
 贝宝工程博客 
  
   
  URL : https://medium.com/paypal-engineering/graphql-a-success-story-for-paypal-checkout-3482f724fb53?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website