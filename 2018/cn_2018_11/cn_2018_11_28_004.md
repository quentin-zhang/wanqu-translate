今年10月,我演讲HashiConf 2018我共享关键教训我们学到了在Gruntwork而创建和维护一个图书馆的300000行代码的基础设施用于生产的数以百计的公司。在这篇文章中,我将与你分享的视频和幻灯片演讲,以及凝聚,书面版的5个重要教训。 
 虽然行业的尖端buzzwords-Kubernetes microservices,服务网格,不变的基础设施,大数据,数据湖泊等现实情况是,当你深陷在建设基础设施,它不会感觉前沿。 
 对我来说,DevOps感觉更像这样: 
 建设工业生产基础设施是很困难的。和压力。和时间消耗。非常耗费时间。 
 大约多久你应该期待您的下一个基础设施项目,根据经验数据我们聚集在数百种不同的公司: 
 DevOps项目总是超过你预期的方式。总是这样。这是为什么呢? 
 第一个原因是牦牛剃须,完全见这中间片段马尔科姆: 
 第二个原因是建筑工业生产基础设施(如,基础设施的类型你打赌公司)包括一千小细节。绝大多数的开发人员不知道这些细节,所以当你评估一个项目时,你通常会忘记consuming-details数量的关键和时间。 
 为了避免这个问题,每次你去工作在一个新的基础设施,通过以下清单: 
 不是每一块基础设施需求名单上的每一个项目,但是你应该有意识地和明确文件,物品你已经实现,哪些你决定跳过,及其原因。 
 截至2018年,这是我们使用的主要工具在Gruntwork构建和管理基础设施: 
 现在,所有这些工具都是有用的,但这并不是真正的教训。真正的教训是,工具,本身是不够的。你也需要改变你的团队的行为。 
 特别是,世界上最好的工具是不会帮助你的团队一点如果你的团队没有买到使用这些工具或如果你的团队没有足够的时间来学习使用这些工具。因此,关键在于使用基础设施代码是一项投资:有一个预先成本发生,但是如果你明智的投资,你会长期获得大回报。 
 基础设施代码新手往往定义所有的基础设施为他们所有的环境(开发、舞台、刺激等)在一个文件或一组文件部署为一个单元。这是一个糟糕的主意。 
 这里有几个缺点: 
 简而言之,你应该建立代码小,独立的、可重用、可组合模块。这不是一个新的或有争议的洞察力。你以前听过一千次,尽管略有不同的域: 
 如果您的基础结构代码没有自动化测试,它坏了。你不知道它。也就是说,测试基础设施代码是很难的。你真的没有“localhost”(例如,你不能上部署一个AWS VPC笔记本电脑),你真的没有“单元测试”(例如,你不能孤立起程拓殖代码从“外部”世界所有起程拓殖是跟外面的世界)。 
 因此,为了正确地测试您的基础结构代码,您通常需要将其部署到实际环境中,实际运行的基础设施,验证它应该,然后拆除一切(对于这种风格的测试,看到Terratest,一个开源库,包括工具测试起程拓殖,封隔器,和码头工人的代码,使用AWS,质量,和Kubernetes api,执行shell命令在本地和远程服务器上的/ SSH,等等)。这意味着,与基础设施测试,你必须稍微重新定义术语: 
 注意,图中是一个吡定 
 之际,我们有许多单元测试,数量小的集成测试,和一个非常小的数量的e2e测试。为什么?因为每种类型的测试需要多长时间: 
 与基础设施测试周期时间是缓慢的,尤其是当你去金字塔,所以你会想抓住尽可能多的错误你可以尽可能低的金字塔。这意味着你应该: 
 现在让我们把这个演讲的一切在一起。这是你会如何构建和管理基础设施从现在开始: 
 Gruntwork创始人之一的作者“你好,启动”和“起程拓殖:启动和运行” 
 Gruntwork博客 
  
   
  URL : https://blog.gruntwork.io/5-lessons-learned-from-writing-over-300-000-lines-of-infrastructure-code-36ba7fadeac1?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website