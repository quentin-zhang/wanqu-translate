杰里米·赫尔曼&迈克Del Balso 
 2017年9月,我们发表了一篇文章介绍米开朗基罗,超级的机器学习平台,更广泛的技术社区。在这一点上,我们有一年多的生产经验在我们的腰带与平台的第一个版本,并使用一些我们的团队构建、部署和运行他们的机器学习(ML)系统。 
 随着我们的平台的成熟和超级的服务增长,我们看到爆炸的ML部署整个公司。在任何给定的时间,数百名代表成千上万的用例模型部署在生产平台。数以百万计的预测每一秒,和数以百计的数据科学家,工程师,产品经理,研究人员毫升解决方案在公司工作。 
 在本文中,我们回顾毫升的进化在乳房从平台的角度在过去三年。我们回顾这段旅程通过查看路线开发超级毫升,米开朗基罗和规模提供深入研究超级目前的方法和未来的目标转向发展中毫升平台,并提供一些经验教训。除了技术方面的平台,我们也看重要的组织和流程设计方面的考虑,对我们的成功至关重要,在超级毫升。 
   
 2015年,毫升不是超级广泛使用,但随着公司规模和服务变得更加复杂,很明显,有机会毫升带来变革性的影响,毫升的和普遍的想法部署公司迅速成为一个战略重点。 
 而米开朗基罗从一开始的目标是民主化毫升Uber,我们开始小然后增量地构建系统。米开朗基罗最初的重点是使大规模批量训练和productionizing批量预测工作。随着时间的推移,我们添加了一个集中的存储特性,模型性能报告,一个低延迟的实时预测服务,深度学习工作流,笔记本集成,分区模型,和许多其他组件和集成。 
 在三个几年,超级从没有集中毫升努力和一些定制毫升系统拥有先进毫升工具和基础设施,生产,数百毫升用例。 
 超级为一个非常多样化的应用程序使用毫升。而不是应用毫升几个关键领域(如广告优化或内容相关性),超级有一个甚至更多的ML传播解决方案。在本节中,我们将讨论少数米开朗基罗的用例,在过去的三年里,在超级突出毫升的多样性和影响: 
 超级吃使用许多机器学习的模型建立在米开朗基罗的预测使数以百计的优化食客体验每一次应用程序打开。 
 ML-powered排名模型显示餐馆和菜单项基于历史数据和信息从用户的当前会话的应用(如他们的搜索查询)。  
 使用米开朗基罗,超级吃餐还估计到达时间根据预测的贱民,历史数据,以及各种实时信号和餐馆用餐。 
 超级市场团队利用各种时空预测模型能够预测骑手和driver-partner可用性需求将在未来在不同的时期和不同的地点。基于预测供需失衡,超级系统可以鼓励driver-partners提前去那里会骑的最大的机会。 
 每天约1500万旅行发生在乳房。人们经常离开钱包或手机在车里或有其他问题,导致成千上万的支持门票每天通过我们的帮助系统。这些票是路由到客户服务代表。机器学习模型在米开朗基罗建造大量使用自动化或加速大标准 
 ts的应对和解决这些问题的过程。这些模型的第一个版本,基于提高了树木,加快票处理时间10%相似或更好的客户满意度。第二个版本,基于深度学习模式,加速开车一个额外的6%。 
 自2010年第一个超级骑,GPS数据被用来把地图上的每一个旅行所以我们知道当你骑,谁是背后的车轮。但我们可以做更多的事情:通过利用GPS和其他传感器的力量驱动的智能手机,我们的技术可以检测可能的崩溃。这项技术还可以标记访问违规崩溃可能之外,在一些罕见的情况下,表明增加安全风险。例如,如果有一个长,意外停止时,骑手和司机都将收到一个通知通过我们骑检查功能,提供援助在发生崩溃。 
 最重要的一个,可见公司的指标是骑手皮卡的贱民。准确的贱民是至关重要的一个积极的用户体验,而这些指标被送入其他内部系统,以帮助确定价格和路由。然而,贱民是出了名的困难。 
 超级的地图服务团队开发了一套先进的segment-by-segment路由系统,用于计算基础η值。这些基地贱民有一致的错误模式。地图服务团队发现他们可以利用机器学习模型来预测这些错误,然后使用预测误差修正。这个模型是推出了像现在这样逐个(然后全球在过去几年),我们看到贱民的准确性大幅增加,在某些情况下平均埃塔误差减少50%以上。 
 一个点击聊天功能流线骑手和driver-partners之间的通信通过使用自然语言处理(NLP)模型,预测和最可能的回复应用内聊天信息显示。让driver-partners应对骑手聊天信息用一个按钮按下减少分心。 
 超级无人驾驶汽车系统使用深度学习模型的多种功能,包括对象检测和运动计划。建模者使用米开朗基罗的Horovod高效的分布式的大型模型训练大量的GPU的机器。 
  
   
 作为一个平台团队,我们的使命是解锁毫升和加速其采用的价值公司的各个角落。我们通过民主化的工具和支持我们的技术团队需要,即优化开发速度,端到端所有权,软件工程严格,和系统的灵活性。 
 数据科学家,我们的工具简化了生产和操作系统的构建和部署毫升、端到端启用他们自己的工作。工程师,超级的ML工具简化了数据科学(工程特性、建模、评价等)在这些系统中,方便他们训练足够高质量的模型不需要数据的科学家。最后,对于经验丰富的工程团队构建专门的ML系统,我们提供米开朗基罗毫升基础设施组件的可定制的配置和工作流。 
 成功地扩展毫升公司像超级不仅仅需要得到技术在这里组织和流程设计的重要考虑因素。在本节中,我们看看关键成功因素在三个支柱:组织、流程以及技术。 
 不同要求毫升问题和有限的专家资源使组织设计尤其重要,挑战机器学习。虽然有些毫升项目在超级属于团队与多个毫升工程师和数据科学家,其他人则属于没有专业技术团队。同样的,一些问题可以求解 
 ed的新手常见的开箱即用的算法,而其他问题需要专家调查与先进技术(通常是不知道解决方案)。 
 让合适的人工作在合适的问题一直是构建高质量的解决方案的关键生产和部署他们坚持和成功。面临的挑战是在分配稀缺的专家资源和放大的影响许多不同ML的问题。例如,如果一个新项目需要计算机视觉技术,组织结构将允许超级有效地分配专家资源的方式与公司重点吗? 
 若干次迭代后,超级目前使用以下主要角色和职责: 
 让我们看看一些关键的团队和他们如何共同设计、构建和部署新的ML系统在生产中。 
 我们发现最好的作品如果产品工程团队的模型构建和部署在生产。例如,我们的地图服务团队拥有的模型预测超级的贱民。产品团队通常配备全套的技能他们需要使用超级的ML平台构建和部署模型。当他们需要更多的专业知识,从研究和/或获得援助专家团队。 
 产品组织有时也有特殊的团队帮助解决任何差距平台提供和特定的产品工程团队所需要的东西。这些团队适应集中平台工具的使用情况并填写功能差距与定制工具和工作流。例如,许多团队在超级市场周围组织有相似的工作流程培训,每城市和产品评估和部署模型。一个市场团队创建专门的工具,坐上的米开朗基罗,使其更容易管理这些市场毫升项目。 
 当产品工程团队遇到毫升伸展自己的能力或资源的问题,他们可以向内部的专家团队寻求帮助。超级的专家有很深的专业知识在不同的域(如NLP,计算机视觉,推荐系统,预测和与产品工程团队合作来构建定制的解决方案。例如,我们科项目是一项对专家团队与产品团队为我们的业务和客户产生巨大的影响。 
 通常情况下,这些项目最后几周很多方面。作为一个项目(和移动接近启动生产,产品团队经常添加相关全职专家来填补技能差距,确保他们能自己维护的系统,和免费的专家资源。 
 专家和产品工程团队经常参与超级人工智能研究小组,人工智能实验室的问题上进行合作,帮助指导未来研究的方向。研究团队通常不自己的生产代码,但是他们经常与不同的团队密切合作应用问题。当相关的新技术和工具开发的人员,平台工程团队整合全公司的平台,允许新技术很容易利用整个公司。 
 米开朗基罗平台团队构建和运行一个通用毫升工作流和工具集直接使用的产品工程团队构建、部署和操作机器学习解决方案。 
 随着系统越来越复杂和我们解决更复杂的问题,需要增加额外的灵活性,可扩展性和特定领域的ML开发经验。我们旋转的其他更特定于域的平台来解决专业的用例也不是由米开朗基罗工作流工具。这些新平台团队重用现有的很多米开朗基罗平台和提供专业毫升开发工作流产品团队。例如,基于“增大化现实”技术 
 e NLP和计算机vision-specific平台正在建设包含特殊的可视化工具,pre-trained模型、元数据跟踪,和其他组件,不适合在一个通用的平台。 
 随着超级毫升业务成熟,许多过程已经证明有用我们的团队的效率和有效性。毫升分享最佳实践(例如,数据组织方法,实验,和部署管理)和建立更加结构化的流程(例如,发布评论)是有价值的方式来指导团队和避免重复别人的错误。内部社区建设工作重点和透明的规划过程参与和对齐毫升团队共同的目标。 
 设计可靠的流程来避免共同发展陷阱和验证模型的行为是至关重要的安全扩展毫升在一个组织。毫升系统特别容易受到意想不到的行为,棘手的边界情况,和复杂的法律伦理/隐私问题。然而在实践中,风险概况显著差异在用例,需要定制的批准和发布流程。例如,启动自动更新一个埃塔预测模型,使用匿名数据需要更少的隐私审查比发起一项新的定价模式。 
 由于这些原因,产品组织(如超级市场吃或团队)的发射过程在ML模式。这些团队流程适应他们的产品从一个集中的区域发射剧本,走过一般产品,隐私、法律和伦理主题模型试验和发射毫升左右。产品团队本身最好的理解不同的模型的产品影响的行为和最适合咨询有关专家评估和消除风险。 
 当需求超过平台团队的路线图,产品工程团队可以感觉到分支的欲望和构建自己的系统适合他们的需求。需要小心,以确保团队能够解决自己的问题,但也该公司做好工程权衡避免碎片和技术债务。在乳房,我们组织一个内部的高层领导人监督毫升工具的进化整个公司,以确保我们做出明智的权衡和维持长期架构对齐。这是宝贵的在解决这些棘手的,有时敏感情况。 
 扩展优质毫升整个公司需要一个连接和协作组织。 
 建立一个内部的社区,我们称为UberML主机内部毫升年度会议上。我们最近举办了约500名员工,超过50组呈现会谈或海报在他们的工作。这样的事件使从业人员交换意见,庆祝的成就,使未来合作的重要连接。团队还在乳房组织社区建设活动包括毫升阅读群体,演讲系列,和普通棕色包午餐超级的ML-enthusiasts了解我们的一些内部毫升项目建立他们的个人。 
 我们专注于社区超出自己的墙壁。我们的团队也吸引大量外部毫升社区通过会议、发表论文、参与开源项目,合作毫升项目和与其他公司和学术界的研究。多年来,这个社区已经成长为一个全球努力分享最佳实践,尖端项目上进行合作,普遍提高的状态字段。 
 重要的是毫升团队总是学习。他们需要掌握毫升的发展理论,从内部毫升项目跟踪和学习,掌握我们的ML工具的使用。适当的渠道有效地共享信息和教育ML-related主题是至关重要的。 
 超级ML教育员工的第一周期间开始,在此期间我们主机 
 特别会议的ML和米开朗基罗为所有技术员工训练营。当米开朗基罗的主要新功能发布,我们主机特殊训练的员工经常使用它们。关键工具和用户工作流的文档也帮助鼓励知识共享和使用我们的平台工具。 
 办公时间也由不同的ML-focused组在公司出现问题时提供支持。这也有助于在超级毫升项目工作的人往往会成为自然好奇又饿的学习者。许多社区活动上面提到的是伟大的方式为团队成员跟上内部和外部发展。 
   
 有无数的细节在任何毫升系统的技术方面。在乳房,我们发现以下高层方面尤其重要: 
 在早期,我们认识到,成功的毫升在超级大公司需要的不仅仅是训练好因此你需要健壮的、可伸缩的对整个工作流的支持。我们发现,相同的工作流应用在广泛的场景,包括传统ML和深度学习;监督、非监督和semi-supervised学习;在线学习;批处理、在线和移动部署;和时间序列预测。不是至关重要的一个工具提供了一切(虽然这是我们如何做),但重要的是要有一个综合的工具集,可以解决所有工作流的步骤。 
 这通常是最复杂的一部分毫升过程,包括数据访问、特性发现,选择,和转换发生在模型训练和管道的productionization模型部署时这些特性。Uber,我们构建了一个功能存储,允许团队分享高质量特性和轻松地管理这些功能的离线和在线管道模型训练,然后部署,确保在线和离线版本之间的一致性。 
 在米开朗基罗,用户可以从Python火车模型从我们的web UI或使用我们的数据科学工作台(DSW)下手。在DSW,下手,我们支持大规模分布式培训深度学习GPU集群模型,树和线性模型对CPU的集群,低规模培训的各种各样的模型使用Python的无数工具包。除了训练的简单模型,用户可以编写更复杂的转换管道,乐团,和叠加模型。米开朗基罗还提供可伸缩的网格和随机hyperparameter搜索,以及更高效的贝叶斯黑箱hyperparameter搜索。 
 找到合适的组合数据,算法,hyperparameters是一个实验和迭代过程。快速有效地通过这个过程需要自动化所有的实验和结果。也受益于良好的可视化工具理解每个模型的性能以及能够相互比较多的模型的模式配置和功能改善模型性能的数据。模型管理米开朗基罗严格管理,版本控制,完全复制,有丰富的可视化模型准确性和explainability。 
 一旦训练一个有效的模型,为模型是很重要的开发人员能够将模型部署到一个临时或生产环境中。在米开朗基罗,用户可以通过web UI为了方便或部署模型通过我们的API与外部自动化工具的集成。在部署时,模型和相关资源打包,然后推出离线工作安排批量预测或通过节俭在线实时请求-响应预测的容器。在线和离线模型,系统自动设置管道进行数据存储的功能。 
 模型训练和最初根据历史数据进行评估。这 
 意味着用户可以知道过去模型会工作得很好。但是一旦你部署模型,并使用它来预测新数据,通常很难确保它仍正常工作。模型随着时间的推移可能会降低,因为世界是不断变化的。此外,可能会有破损或缺陷在生产模型的数据源或数据管道。在这两种情况下,监控(报警)预测模型在生产是至关重要的。我们有两种方法在生产监测模型。最准确的方法是预测登录生产然后加入这些收集的结果,因为它们是我们的数据管道;通过比较预测与实际货物,我们可以计算出精确的精度指标。在这种情况下,结果不容易收集或我们无法轻易加入预测结果,第二个选择是监控和预测和比较它们的分布特性。这是一个不那么精确的方法,但是仍然可以经常发现有问题的变化特性和相应的预测。 
 米开朗基罗团队的方法的一个重要的原则是认为机器学习软件工程。开发和生产运行毫升应该作为迭代,严谨、测试,软件工程和方法论。我们发现了很有价值的画之间的类比毫升和软件开发,并应用见解从相应的和成熟的软件开发工具和方法回到毫升。 
 例如,一旦我们认识到一个模型就像一个编译软件图书馆,很明显,我们想要跟踪模型的配置在一个严格的训练,版本控制系统以同样的方式,您的版本控制库的源代码。跟踪一直是重要的资产和配置用于创建模型,以便它可以被复制(和/或改进)。转移的学习深度学习模型,我们跟踪整个家族,这样每一个模型可以重新训练,如果必要的。没有良好的控制和工具,我们所看到的情况下,模型构建和部署,但无法复制,因为数据和/或培训配置已经丢失。 
 此外,确保软件工作正常,重要的是之前运行综合测试软件部署;同样,部署之前,我们总是对抵抗评估模型集。同样,重要的是有良好的监控软件系统,以确保他们正确的生产工作;这同样适用于机器学习,你想在生产监控模型比在离线评估他们的行为可能会有所不同。 
 构建有效的ML系统是一门科学,需要多次迭代。迭代速度影响两毫升尺度如何在组织和高效的团队是如何在任何给定的问题。米开朗基罗的高优先级团队使数据科学团队更快。我们走得越快,我们可以运行更多的实验,假设我们可以测试越多,我们可以得到更好的结果。 
 下面的关系图显示了我们如何看待毫升标准开发过程和不同的反馈循环。我们不断地思考这个过程和收紧这些循环更容易和更快的迭代和敏捷的科学数据。 
 米开朗基罗的“严重速度”或“价值的转换速度”的关键是毫升跨超级传播。新用例,我们专注于降低门槛通过微调开始工作流不同能力的人,有一个简化的流程来获得一个基本的模型和运行良好的缺省值。 
 对于现有的项目,我们看看迭代速度,盖茨数据科学家如何快速迭代和eithe得到反馈的新车型或特性 
 r从一个在线离线测试或实验。 
 几个原则已被证明非常有用的支持团队发展迅速: 
 米开朗基罗开始的时候,最紧急的和最高的影响用例是一些非常高的规模问题,促使我们在Apache火花(大规模数据处理和模型训练)和Java(低延迟、高吞吐量的在线服务)。这个结构很好生产培训和部署的许多模型,但留下了许多所需的开销,灵活性,和易用性,特别是在早期的原型和实验。 
 提供更大的灵活性、易用性和迭代速度,我们正主模型建立工作流Uber DSW。下手的DSW提供灵活和容易获得超级下手的数据基础设施和计算资源在自然笔记本接口。其集成我们的云计算和on-prem GPU集群允许Michelangelo-ready毫升的快速原型模型一个笔记本环境和容易保存这些模型在米开朗基罗的部署和扩展服务。我们过渡到用DSW作为主要模式探索和下手为米开朗基罗的原型界面。 
 在笔记本支持相同的可伸缩的建模环境,我们总是提供通过UI,我们已经发布了(在内部,但我们希望开源不久)的一组库扩展火花提供一套定制的估计量,变压器,和管道组件公开为批处理接口,流媒体,请求/响应得分(后者不可用标准版本的火花)。这些组件可以使用PySpark组装,然后上传到米开朗基罗部署和使用纯java服务系统服务。这汇集了Python的易用性与火花和Java的规模。 
 纯Python建模便于毫升的简单性和获得更丰富的生态系统和数据工具包。为了解决这个问题,我们最近扩大米开朗基罗为任何Python模型从任何来源更灵活的建模支持。用户在DSW笔记本下手建造他们的模型(或其他首选Python环境),然后使用米开朗基罗PyML SDK包和上传存储模型和依赖性米开朗基罗,部署和服务(包括批处理和在线)。 
 深度学习的开发工作流模型往往会有不同的需求比其他毫升开发工作流。开发人员通常编写更多的代码和详细的培训需要专门的计算资源(gpu)。我们很多关注使这个过程顺利和快速的在过去的一年。 
 米开朗基罗现在有很好的工具来提供和运行培训工作在不同的GPU机器都超级的数据中心和各种公共云。生产TensorFlow模型是服务我们的现有大规模的米开朗基罗模型服务基础设施(目前与TensorFlow集成服务)或PyML系统。我们有专门的工具来帮助建模人员跟踪他们的实验和开发,但是一旦一个模型保存在米开朗基罗,就像对待其他模型系统中。 
 自动调谐是一种新的通用optimization-as-a-service超级工具。已经集成到米开朗基罗允许建模者轻松地使用先进的黑盒贝叶斯优化算法更有效地寻找一组最优的hyperparameters。它作为一个新的推荐替代的不那么复杂的搜索算法在米开朗基罗到目前为止我们已经发行。这意味着更精确的模型在相同数量的培训时间或更少的时间去一个高质量的模型。 
 一之间的紧张关系我们发现在开发米开朗基罗为最常见的ML工作流提供的端到端支持,同时提供灵活地支持不太常见的。 
 最初, 
 我们的平台和基础设施组件组合成一个系统。作为我们的系统变得更加复杂,我们正在解决的问题变得更加多样和复杂,需求增长更多的灵活性,可扩展性和特定领域的发展经验可以提供超出了单一的平台。 
 我们可以通过这座桥团队,解决其中的一些问题如上所述。但有些团队想混合和匹配的部分米开朗基罗与自己的组件到新的工作流。其他球队需要专门的开发工具为他们的用例,但它没有意义从头开始构建这些工具。我们做了一些重大变化,米开朗基罗架构尽可能利用现有的系统,同时发展与不断增长的需求毫升成熟整个公司: 
 我们还发现,对于一些问题领域,专业开发经验是有用的。这可以简单预构建工作流申请和评估预测模型也可以定制、交互式学习和标签为特定的计算机视觉应用程序构建工具。我们要支持所有这些用例通过允许开发人员利用米开朗基罗的底层基础设施平台。 
 解决这些问题,我们在分解的过程中从米开朗基罗的基础设施为显式基础架构层,使基础设施可供团队利用建造更多的专业平台,例如,NLP或愿景。一旦这样做,我们将有两个客户组:模型建造者使用米开朗基罗平台构建和部署模型,和ML系统建筑商谁使用米开朗基罗基础设施组件构建定制解决方案或更专业的平台。 
   
 建筑米开朗基罗和帮助在超级大规模机器学习在过去的三年里,我们学到了很多从我们的成功和失败。在某些情况下,我们第一次正确行事,但是更频繁,我们花费了几个迭代周期来发现最适合我们。 
 旅程才刚刚开始,还有许多事要做。这是一个发展的空间,将会有更多的课程学习。如果你有兴趣解决机器学习的挑战,推动规模的局限性,考虑申请一个角色在我们的团队!  
   
 杰里米·赫尔曼和麦克德尔Balso工程和产品经理在乳房的机器学习平台团队。 
   
 ©2018超级技术公司。 
 隐私政策 
 条款和条件 
  
   
  URL : https://eng.uber.com/scaling-michelangelo/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website