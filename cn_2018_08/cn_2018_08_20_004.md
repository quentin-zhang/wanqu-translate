米歇尔·Ufford M Pacer马修·密封和凯尔·凯利 
 笔记本电脑迅速在普及中数据科学家成为事实上的标准快速原型和探索性分析。在Netflix,我们进一步推动边界,重塑一个笔记本,谁可以使用它,他们所能做的。我们进行巨额投资使这一设想成为现实。 
 在这篇文章中,我们将分享我们的动机和为什么我们发现Jupyter笔记本如此引人注目。我们还将介绍组件的笔记本基础设施和探索的一些新颖的方式在Netflix我们使用笔记本。 
 如果你在短时间,我们建议跳下用例部分。 
 权力Netflix的数据。它贯穿于我们的思想,告诉我们的决定,和挑战我们的假设。燃料的实验和创新以前所未有的规模。数据可以帮助我们发现精彩的内容和交付个性化的经验为我们世界各地的1.3亿名成员。 
 这可能是一个不小的壮举;它需要大量的工程和基础设施支持。每天有超过1万亿个事件写进流摄入管道,这是处理和书面100 pb进行数据仓库。每一天,我们的用户对这个数据运行超过150000个工作岗位,涵盖了从报告和分析到机器学习和推荐算法。支持这些用例在这样的规模,我们修建了一个行业领先的数据平台是灵活的,强大的,复杂的(必要性)。我们还建立了一个丰富的生态系统的辅助工具和服务,如精灵、联合作业执行服务,和联邦Metacat metastore。这些工具简化复杂性,从而能够支持更多的用户在整个公司。 
 用户多样性是激动人心的,但这是有代价的:数据平台和生态系统的工具和服务,必须扩展以支持额外的用例,语言,访问模式等等。为了更好的理解这个问题,考虑三种角色:分析工程师,工程师,数据和数据科学家。 
 一般来说,每个角色依赖于一组不同的工具和语言。例如,一个数据工程师可能会创建一个新的聚合的数据集包含数万亿流事件——在IntelliJ使用Scala。分析工程师可以使用聚合在一份新的报告对全球流——使用SQL和画面质量。这报告可能会导致数据科学家构建一个新的流媒体压缩模型,使用R和RStudio。表面上看,这些看起来不同,尽管互补,工作流。但是,如果我们深入调查,我们看到每一个工作流程有多个重叠的任务: 
 数据探索——发生在项目的早期;可能包括查看示例数据,运行查询统计分析和探索性分析、和可视化数据 
 数据准备——迭代任务;可能包括清洗、标准化,转换,denormalizing,和聚合数据;一般项目的最耗时的任务 
 数据验证,重复的任务;可能包括查看示例数据,运行查询统计分析和汇总分析,和可视化数据;通常发生的数据探索、数据准备、开发、部署前,部署后阶段 
 productionalization——发生在项目后期;可能包括将代码部署到生产、回填数据集训练模型,验证数据和调度工作流 
 来帮助我们的用户规模,我们想让这些任务尽可能容易。帮助我们的平台,我们要减少工具的数量我们需要支持。但如何?没有一个工具可以跨越所有这些任务;更重要的是,一个单一的任务通常需要多个工具。当我们添加另一个抽象层,然而,一个常见的模式出现在工具并出口 
 年龄:运行代码,探索数据,目前的结果。 
 碰巧,一个开源项目旨在切实地实现这一目的:项目Jupyter。 
 项目Jupyter始于2014年,目标是创建一组一致的开源工具,用于科学研究,可再生的工作流,计算叙述,和数据分析。这些工具翻译行业,今天Jupyter笔记本已经成为一个重要的数据科学家工具包的一部分。给你的影响,Jupyter被授予2017年软件系统ACM奖-一荣誉和Java,Unix和网络。 
 要理解为什么Jupyter笔记本对我们来说是如此引人注目,考虑它所提供的核心功能: 
 Jupyter协议提供了一个标准的消息传递API与内核,作为计算引擎。协议允许一个可组合架构,将内容写(UI),执行代码(内核)。通过孤立运行时的界面,笔记本可以跨多个语言同时保持执行环境是如何配置的灵活性。如果内核存在语言,知道如何使用Jupyter协议通信,笔记本电脑可以运行代码,发送消息来回内核。 
 支持所有这个文件格式存储代码和结果。这意味着结果可以访问后无需重新运行代码。此外,笔记本商店丰富的散文给上下文笔记本内发生了什么。这使它的理想格式沟通业务上下文,记录的假设,注释代码,描述的结论等等。 
 我们的许多用例,最常见的方法我们使用笔记本今天是:数据访问、笔记本模板和调度的笔记本。 
 笔记本在Netflix首次引入科学工作流的支持数据。采用数据科学家之间的增长,我们看到规模我们工具努力的机会。我们意识到我们可以利用Jupyter笔记本和扩展的多功能性和架构通用数据访问。2017年第三季度我们开始认真工作,提升笔记本电脑从一个利基工具一等公民的数据平台。 
 从用户的角度来看,笔记本电脑提供了一个方便的界面迭代运行代码,输出,探索和可视化数据——所有从一个基于云的开发环境。我们还保持一个Python库,巩固访问平台api。这意味着用户编程访问几乎整个平台在一个笔记本上。因为这种多功能性的结合,力量,和易用性,我们看到快速有机采用为所有用户类型在整个数据平台。 
 今天,笔记本电脑是最受欢迎的工具处理数据在Netflix。 
 我们扩大了笔记本平台支持,我们开始引入新功能来满足新的用例。从这个工作出现了参数化的笔记本。一个参数化的笔记本正是这听起来像:一个笔记本,允许您指定参数在运行时代码并接受输入值。这为用户提供了一个很好的机制来定义笔记本作为可重用模板。 
 我们的用户发现这些模板数量惊人的用途。一些最常见的有: 
 更新奇的方法之一我们利用笔记本电脑作为调度的统一层工作流。 
 因为每个笔记本可以针对任意运行的内核,我们可以支持任何用户定义的执行环境。因为笔记本描述执行的线性流,破坏了细胞,我们可以失败映射到特定的细胞。这允许用户执行描述一个简短的叙述和可视化,我们可以准确地报告在稍后的时间点运行时。 
 这对于interac范例意味着我们可以使用笔记本电脑 
 有效工作和顺利搬到调度工作循环运行。对于用户来说,这是非常方便的。许多用户构建整个工作流的笔记本,只需要复制/粘贴到单独的文件安排当他们准备部署它。把笔记本电脑作为一个逻辑流程,我们可以很容易地安排它与任何其他工作流。 
 我们可以通过笔记本电脑安排其他类型的工作,。当火花或转眼间工作执行调度程序,源代码注入新设立的一个笔记本和执行。笔记本就变成了一个不可变的历史记录,包含所有相关的工件,包括源代码,参数,运行时配置,执行日志、错误消息,等等。当故障排除故障,这提供了一个快速入口点调查,所有相关信息是托管的和交互式的笔记本可以启动调试。 
 支持Netflix规模的这些用例需要广泛的支持基础设施。让我们简要地介绍一些项目我们将讨论。 
 实习是一个下一代React-based UI Jupyter笔记本。它提供了一个简单,直观的界面,并提供了一些改进经典Jupyter UI,内联等细胞工具栏拖可以滴落的细胞,一个内置的数据浏览。 
 造纸厂是参数化的图书馆、执行和分析Jupyter笔记本。,可以产生多个笔记本用不同参数集和并发执行它们。造纸厂也可以帮助收集和总结指标从笔记本的集合。 
 通勤是一个轻量级,vertically-scalable服务查看和共享笔记本。它提供了一个Jupyter-compatible API版本的内容,使其简单阅读笔记本地存储或Amazon S3。它还提供了一个目录浏览器查找和共享笔记本。 
 提图斯是一个容器管理平台,提供可伸缩的、可靠的容器执行和原生云与Amazon AWS的集成。提多是建立在Netflix和内部生产中用于电力Netflix流,建议,和内容体系。 
 我们将更深入地探索这个基础设施在未来的博客文章。现在,我们将关注三个基本组成部分:存储、计算、和接口。 
 Netflix数据平台依靠Amazon S3和EFS云存储,笔记本将其视为虚拟文件系统。这意味着每个用户都有一个家在EFS目录,其中包含笔记本电脑的个人空间。该工作空间是我们存储任何笔记本创建或由用户上传。这也是所有阅读和写作活动发生在一个用户交互式地启动一个笔记本。我们依靠(工作区+文件名)的结合形成了笔记本的名称空间,例如/ efs /用户/ kylek /笔记本电脑/ MySparkJob.ipynb。我们使用这个名称空间用于查看、分享和调度的笔记本。本公约防止碰撞和便于识别用户和笔记本的位置在EFS体积。 
 我们可以依靠抽象的工作区路径从用户基于云存储的复杂性。例如,只有一个笔记本显示在目录的文件名列表,例如MySparkJob.ipynb。这个文件是在~ /笔记本电脑/ MySparkJob访问。ipynb终端。 
 当用户日程笔记本时,调度程序复制用户的笔记本从EFS S3上常见的目录。笔记本在S3调度器成为真理的来源,或源笔记本。每次调度程序运行一个笔记本,它实例化一个新的笔记本从源笔记本。这个新笔记本真正执行并成为不可变的记录执行,包含代码,输出,从每个细胞和日志。我们称此为输出的笔记本。 
 合作是我们如何在Netflix工作的基础。是当用户而言却没有什么大惊小怪的 
 开始共享笔记本的url。随着这一实践的成长,我们遇到意外频繁问题覆盖由多人同时访问相同的笔记本。我们的用户想要分享他们的活跃的笔记本一个只读状态。这导致通勤的创建。在幕后,通勤表面的Jupyter api /文件和/ api /内容列出目录,查看文件内容和文件元数据的访问。这意味着用户可以安全地查看笔记本电脑而不影响生产工作或live-running笔记本。 
 管理计算资源是最具挑战性的部分之一,处理数据。在Netflix尤其如此,我们雇佣了一个高度可伸缩集装箱建筑在AWS上。数据平台运行在容器上的所有工作,包括查询、管道和笔记本。当然,我们想要抽象尽可能多的这种复杂性。 
 容器是配置当用户启动一个笔记本电脑服务器。我们为容器资源提供合理的默认值,适合~ 87.3%的执行模式。这还不够时,用户可以使用一个简单的接口请求更多的资源。 
 我们还提供一个统一的执行环境和准备容器的形象。图像公共库,默认内核预装的数组。不是所有的图像是静态的——我们的内核把最新版本的火花和最新的集群配置平台。这减少了摩擦和设置时间为新笔记本和通常使我们一个执行环境。 
 引擎盖下面我们管理提多的编排和环境,我们的码头工人容器管理的服务。我们进一步通过管理包装服务用户的特定服务器配置和形象。图像还包括用户安全组和角色,以及常见的身份在环境变量包括库。这意味着我们的用户可以花更少的时间在基础设施和更多的时间数据。 
 早些时候我们描述我们的愿景为笔记本电脑成为处理数据的工具选择。但这是一个有趣的挑战:如何让一个接口支持所有用户?我们完全不知道答案,但我们有一些想法。 
 我们知道我们想要瘦到简单。这意味着一个直观的用户界面简约的美感,同时也需要一个体贴的用户体验,让用户可以更方便做困难的事情。这个理念非常符合实习的目标,Jupyter笔记本React-based前端。它强调简单性和可组合性为核心的设计原则,这使得它的理想构建块的工作要做。 
 我们听见从用户最常见的投诉之一是缺乏本地跨语言边界数据可视化,特别是对于非python语言。实习的数据资源管理器是一个很好的例子,如何可以使困难的事情更简单快速提供语言无关的方式探索数据。 
 你可以看到数据浏览器在MyBinder行动在这个示例的笔记本。(请注意:它可能花一分钟加载) 
 我们也引入了本地支持参数化,这使得它更容易安排笔记本和创建可重用模板。 
 虽然笔记本已经在Netflix提供很多有价值的,我们刚刚开始。我们知道我们需要在前端和后端进行投资来提高整体的笔记本体验。我们的工作在未来12个月内重点是提高可靠性、可见性、和协作。上下文对用户来说是至关重要的,这就是为什么我们增加可见性集群状态,内核状态,工作经历等等。我们也致力于自动版本控制,本机应用程序调度,更好地支持可视化火花DataFrames Scala内核和更大的稳定性。我们将详细介绍这项工作在以后的博文。 
 Netflix长期以来支持 
 的开源的。我们重视能源、开放标准和交换思想,摆脱开源协作。许多应用程序开发的Netflix数据平台已经通过Netflix OSS开源。我们也故意不创建一次性的解决方案或屈服于“非我发明”的心态。只要有可能,我们利用,导致现有的开源项目,如火花,Jupyter和熊猫。 
 我们描述的基础设施在很大程度上依赖于项目Jupyter生态系统,但也有一些我们有分歧的地方。最值得注意的是,我们选择实习作为Netflix笔记本UI。我们做出这个决定的原因很多,包括符合我们的技术和设计理念。当我们推的限制一个笔记本能做什么,我们可能会创建新的工具,图书馆,和服务。这些项目也将开源生态系统作为实习的一部分。 
 我们认识到,什么是有意义的Netflix不一定对每个人来说都是有意义的。我们设计了这些项目通过模块化的方式。这只可以选择为您的环境意义的组件,例如造纸厂,不需要对整个生态系统的承诺。 
 作为一个平台团队,我们的责任是让名人用数据做令人惊奇的事情。笔记本在Netflix已经产生了戏剧性的影响。与我们在这个领域的巨大投资,我们很兴奋地看到这种影响生长。如果你想成为它的一部分,看看我们的职位空缺。 
 唷!谢谢你坚持我们度过这漫长的职位。但是我们我们所做的仅仅是表面的笔记本。在我们在下一篇文章中,我们将更深入地讨论笔记本调度背后的架构。在那之前,这里有一些方法来学习更多关于Netflix是用数据做什么和我们如何做: 
 我们也激动赞助今年的JupyterCon。如果你参加,看看我们5会谈的一个工程师,或由我们的展位谈论Jupyter摇摆,实习或数据。 
 从一个快速起立鼓掌欢呼,鼓掌能表示你吃得多喜欢这个故事。 
 学习更多关于Netflix的设计、建造和运营我们的系统和工程组织 
 了解Netflix的世界级工程的努力,公司文化、产品开发等等。 
  
   
  URL : https://medium.com/netflix-techblog/notebook-innovation-591ee3221233?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website